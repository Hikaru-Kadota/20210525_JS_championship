<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>


<!-- 
  ã€œåˆä½“æ‰‹é †ã€œ
     â‘ ã‚’é©åˆ‡ãªå ´æ‰€ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚
     â‘¡htmlã§è¡¨ç¤ºã—ãŸã„éƒ¨åˆ†ã«ãã‚Œãã‚Œã® idã‚’ã‚»ãƒƒãƒˆã—ã¦ä¸‹ã•ã„ã€‚
     ä»¥ä¸Š
     
     idã¯ä»¥ä¸‹ã®é€šã‚Šã€å¤©æ°—ã¯ "w_1,w_2,w_3ãƒ»ãƒ»ãƒ»"   æ°—æ¸©ã¯ "t_1,t_2,t_3ãƒ»ãƒ»ãƒ»"  ã¨è¨­å®šã—ã¦ã„ã¾ã™ã€‚

 -->

<body>

  <div>
    <span id="name"></span>ã•ã‚“ãŒä»Šã„ã‚‹ã“ã®å ´æ‰€ã®å¤©æ°—ã¯ã€
  </div>

  <div>
    ä»Šæ—¥ã¯<span id="w_1"></span>
    ã€æ°—æ¸©ã¯<span id="t_1"></span>åº¦
  </div>


  <div>
    æ˜æ—¥ã¯<span id="w_2"></span>
    ã€æ°—æ¸©ã¯<span id="t_2"></span>åº¦
  </div>


  <div>
    æ˜å¾Œæ—¥ã¯<span id="w_3"></span>
    ã€æ°—æ¸©ã¯<span id="t_3"></span>åº¦
  </div>

  <div>
    3æ—¥å¾Œã¯<span id="w_4"></span>
    ã€æ°—æ¸©ã¯<span id="t_4"></span>åº¦
  </div>

  <div>
    4æ—¥å¾Œã¯<span id="w_5"></span>
    ã€æ°—æ¸©ã¯<span id="t_5"></span>åº¦
  </div>

  <div>
    5æ—¥å¾Œã¯<span id="w_6"></span>
    ã€æ°—æ¸©ã¯<span id="t_6"></span>åº¦
  </div>



  <!-------------------------------- â‘ ğŸ‘‡ğŸ‘‡ã“ã“ã‹ã‚‰ä¸‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ğŸ‘‡ğŸ‘‡ ---------------------------------->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $(document).ready(function () {
      'use strict'
      const APIKEY = "99e9fe4e103779f3e7f4906e498ef3b7";
      //ç¿Œæ—¥9æ™‚ã®ãƒ‡ãƒ¼ã‚¿ã®å ´æ‰€ã‚’å‰²ã‚Šå‡ºã™
      const date = new Date();
      const nowHour = date.getHours();
      const whichTomorrowWeatherData = Math.floor((24 - nowHour + 9) / 3);
      const whichDayAfterTomorrowWeatherData = Math.floor((24 - nowHour + 33) / 3);
      const threeDaysLaterData = Math.floor((24 - nowHour + 57) / 3);
      const fourDaysLaterData = Math.floor((24 - nowHour + 81) / 3);
      const fiveDaysLaterData = Math.floor((24 - nowHour + 105) / 3);
      let user_name = location.search.substring(1);
      //ç¾åœ¨ä½ç½®ã®å–å¾—ãŒã§ãã‚‹ã‹ã©ã†ã‹
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
        // ç¾åœ¨ä½ç½®ã®å–å¾—ã«æˆåŠŸã—ãŸå ´åˆ
        function success(position) {
          const positionData = position.coords;
          //ç·¯åº¦çµŒåº¦ã®å–å¾—ã¨è¡¨ç¤º
          const lat = positionData.latitude;
          const lon = positionData.longitude;
          $('#location').text('ç¾åœ¨ã®ä½ç½®ï¼ˆ' + Math.floor(lat * 100) / 100 + ',' + Math.floor(lon * 100) / 100 + ')');
          //ç¾åœ¨ã®å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã‚’å‘¼ã³å‡ºã—
          $.ajax({
            url: "http://api.openweathermap.org/data/2.5/weather",
            dataType: "jsonp",
            data: "lat=" + lat + "&lon=" + lon + "&appid=" + APIKEY,
            //å¤©æ°—ãƒ‡ãƒ¼ã‚¿å‘¼ã³å‡ºã—æˆåŠŸæ™‚ã®æŒ™å‹•
            success: function (data) {
              if (data.weather[0].main === "Clear") {
                $('#w_1').text("æ™´ã‚Œ");
              } else if (data.weather[0].main === "Rain") {
                $('#w_1').text("é›¨");
              } else if (data.weather[0].main === "Clouds") {
                $('#w_1').text("ãã‚‚ã‚Š");
              } else if (data.weather[0].main === "Snow") {
                $('#w_1').text("é›ª");
              }
              //å„ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤º
              $('#t_1').text(Math.floor((data.main.temp - 273.15) * 10) / 10);
            }
          });
          //æ˜æ—¥ã®å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã‚’å‘¼ã³å‡ºã—
          $.ajax({
            url: "http://api.openweathermap.org/data/2.5/forecast",
            dataType: "jsonp",
            data: "lat=" + lat + "&lon=" + lon + "&appid=" + APIKEY,
            //å¤©æ°—ãƒ‡ãƒ¼ã‚¿å‘¼ã³å‡ºã—æˆåŠŸæ™‚ã®æŒ™å‹•
            success: function (data) {
              //ç¿Œæ—¥9æ™‚ã®å¤©æ°—ãƒ‡ãƒ¼ã‚¿
              const targetData1 = data.list[whichTomorrowWeatherData];
              const targetData2 = data.list[whichDayAfterTomorrowWeatherData];
              const targetData3 = data.list[threeDaysLaterData];
              const targetData4 = data.list[fourDaysLaterData];
              const targetData5 = data.list[fiveDaysLaterData];
              //æ™´ã‚Œã¨ã‹æ›‡ã‚Šã¨ã‹ã‚’è¡¨ç¤ºã•ã›ã‚‹å‡¦ç†------------------------------------------------------------------------------
              $('#name').text(user_name);

              if (targetData1.weather[0].main === "Clear") {
                $('#w_2').text("æ™´ã‚Œ");
              } else if (targetData1.weather[0].main === "Rain") {
                $('#w_2').text("é›¨");
              } else if (targetData1.weather[0].main === "Clouds") {
                $('#w_2').text("ãã‚‚ã‚Š");
              } else if (targetData1.weather[0].main === "Snow") {
                $('#w_2').text("é›ª");
              }
              if (targetData2.weather[0].main === "Clear") {
                $('#w_3').text("æ™´ã‚Œ");
              } else if (targetData2.weather[0].main === "Rain") {
                $('#w_3').text("é›¨");
              } else if (targetData2.weather[0].main === "Clouds") {
                $('#w_3').text("ãã‚‚ã‚Š");
              } else if (targetData2.weather[0].main === "Snow") {
                $('#w_3').text("é›ª");
              }
              if (targetData3.weather[0].main === "Clear") {
                $('#w_4').text("æ™´ã‚Œ");
              } else if (targetData3.weather[0].main === "Rain") {
                $('#w_4').text("é›¨");
              } else if (targetData3.weather[0].main === "Clouds") {
                $('#w_4').text("ãã‚‚ã‚Š");
              } else if (targetData3.weather[0].main === "Snow") {
                $('#w_4').text("é›ª");
              }
              if (targetData4.weather[0].main === "Clear") {
                $('#w_5').text("æ™´ã‚Œ");
              } else if (targetData4.weather[0].main === "Rain") {
                $('#w_5').text("é›¨");
              } else if (targetData4.weather[0].main === "Clouds") {
                $('#w_5').text("ãã‚‚ã‚Š");
              } else if (targetData4.weather[0].main === "Snow") {
                $('#w_5').text("é›ª");
              }
              if (targetData5.weather[0].main === "Clear") {
                $('#w_6').text("æ™´ã‚Œ");
              } else if (targetData5.weather[0].main === "Rain") {
                $('#w_6').text("é›¨");
              } else if (targetData5.weather[0].main === "Clouds") {
                $('#w_6').text("ãã‚‚ã‚Š");
              } else if (targetData5.weather[0].main === "Snow") {
                $('#w_6').text("é›ª");
              }
              ///æ°—æ¸©ã‚’è¡¨ç¤ºã™ã‚‹å‡¦ç†------------------------------------------------------------------------------
              $('#t_2').text(Math.floor((targetData1.main.temp - 273.15) * 10) / 10);
              $('#t_3').text(Math.floor((targetData2.main.temp - 273.15) * 10) / 10);
              $('#t_4').text(Math.floor((targetData3.main.temp - 273.15) * 10) / 10);
              $('#t_5').text(Math.floor((targetData4.main.temp - 273.15) * 10) / 10);
              $('#t_6').text(Math.floor((targetData5.main.temp - 273.15) * 10) / 10);
              //-----------------------------------------------------------------------------------------------
            }
          });
        }
        //ç¾åœ¨ä½ç½®ã®å–å¾—ã«å¤±æ•—ã—ãŸå ´åˆ
        function error(error) {
        }
        //ç¾åœ¨ä½ç½®ãŒãã‚‚ãã‚‚å–å¾—ã§ããªã„å ´åˆ
      } else {
      }
    }());
  </script>



  <!-------------------------------- ğŸ‘†ğŸ‘† ã“ã“ã¾ã§ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ ğŸ‘†ğŸ‘† ---------------------------------->





</body>

</html>